{
  "$schema": "https://docs.renovatebot.com/renovate-schema.json",
  "extends": ["group:monorepos"],
  "dependencyDashboard": true,
  "rangeStrategy": "replace",

  // Schedule Renovate to run during off-peak hours
  "schedule": [
    "after 10:00pm every weekday",
    "before 4:00am every weekday",
    "every weekend"
  ],
  "prHourlyLimit": 4,
  "timezone": "America/Tijuana",

  // Commit and PR customization
  "commitBody": "See associated pull request for more information.",
  "semanticCommits": "enabled",
  "semanticCommitScope": "",
  "semanticCommitType": "build",
  "labels": ["area: build & ci", "action: review"],

  // Maintain lock files regularly to ensure consistency
  "lockFileMaintenance": {
    "enabled": true
  },

  "packageRules": [
    // ============================================================================
    // GENERAL GROUPING & UPDATE BEHAVIOR
    // ============================================================================

    // Group all non-major updates (minor and patch) together
    {
      "groupName": "all non-major dependencies",
      "matchPackageNames": ["*"],
      "matchUpdateTypes": ["digest", "patch", "minor"]
    },

    // ============================================================================
    // ECOSYSTEM-SPECIFIC GROUPING
    // ============================================================================

    // Group Bazel updates by package name or manager
    {
      "groupName": "bazel dependencies",
      "matchPackageNames": ["@bazel/**"]
    },
    {
      "groupName": "bazel dependencies",
      "matchManagers": ["bazel"]
    },

    // Group updates related to Angular ecosystem across repositories
    {
      "groupName": "cross-repo angular dependencies",
      "followTag": "next",
      "separateMajorMinor": false,
      "schedule": ["at any time"],
      "matchPackageNames": [
        "@angular/**",
        "angular/**",
        "@angular-devkit/**",
        "@schematics/**",
        "ng-packagr"
      ]
    },

    // Disable 'next' tag tracking on non-main branches
    {
      "matchBaseBranches": ["!/main/"],
      "followTag": null
    },

    // ============================================================================
    // DEPENDENCY-SPECIFIC UPDATE CONTROLS
    // ============================================================================

    // Disable major updates for specified dependencies
    {
      "enabled": false,
      "matchPackageNames": [
        "@types/node",
        "rxjs",
        "tslib",
        "node",
        "pnpm",
        "npm",
        "yarn"
      ],
      "matchUpdateTypes": ["major"]
    },

    // Keep minor and patch updates separate for TypeScript
    {
      "matchPackageNames": ["typescript"],
      "separateMinorPatch": true
    },

    // Group TypeScript-related packages
    {
      "groupName": "typescript dependencies",
      "matchPackageNames": ["typescript", "tslib"]
    },

    // Allow only minor and patch updates for runtime tools
    {
      "groupName": null,
      "matchPackageNames": ["node", "pnpm", "npm", "yarn"],
      "matchUpdateTypes": ["digest", "minor", "patch"]
    },

    // Fully disable TypeScript major & minor updates
    {
      "enabled": false,
      "matchPackageNames": ["typescript"],
      "matchUpdateTypes": ["major", "minor"]
    },

    // ============================================================================
    // WORKFLOW-SPECIFIC UPDATE RULES
    // ============================================================================

    // Group dependencies in the scorecard GitHub Actions workflow
    {
      "groupName": "scorecard action dependencies",
      "matchFileNames": [".github/workflows/scorecard.yml"],
      "matchPackageNames": ["*"]
    },

    // ============================================================================
    // EXCLUSION RULES
    // ============================================================================

    // Disable updates for placeholder or 0.0.0-style versions
    {
      "enabled": false,
      "matchCurrentVersion": "/^[~^]?0\\.0\\.0-/"
    }
  ]
}
